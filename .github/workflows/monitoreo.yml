name: Monitoreo de Viento

on:
  schedule:
    - cron: "*/5 * * * *"   # Cada 5 minutos
  workflow_dispatch:        # Permite lanzarlo manualmente tambiÃ©n

jobs:
  run-scripts:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repositorio
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      - name: Instalar dependencias
        run: |
          pip install requests beautifulsoup4

      - name: Ejecutar script 330021.py #espero ahora funcione
        env:
          CORREO_ORIGEN: ${{ secrets.CORREO_ORIGEN }}
          CONTRASENA: ${{ secrets.CONTRASENA }}
          DESTINATARIOS: ${{ secrets.DESTINATARIOS }}
        run: |
          echo "ðŸš€ Ejecutando 330021.py..."
          python 330021.py

      - name: Ejecutar script 330114.py
        env:
          CORREO_ORIGEN: ${{ secrets.CORREO_ORIGEN }}
          CONTRASENA: ${{ secrets.CONTRASENA }}
          DESTINATARIOS: ${{ secrets.DESTINATARIOS }}
        run: |
          echo "ðŸš€ Ejecutando 330114.py..."
          python 330114.py
# --- Commit de los CSVs al repo (usa GITHUB_TOKEN) ---
- name: Commit data CSVs
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  run: |
    git config user.name "github-actions[bot]"
    git config user.email "github-actions[bot]@users.noreply.github.com"
    git add data/330021.csv || true
    git add data/330114.csv || true
    git commit -m "Add measurements (automated)" || echo "No changes to commit"
    # push usando token (reemplaza el repositorio automÃ¡ticamente)
    git push https://x-access-token:${GITHUB_TOKEN}@github.com/${{ github.repository }} HEAD:main
